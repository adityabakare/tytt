<!DOCTYPE html>
<html lang="en">

<head>


  {% load static %}
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>VIIT TIMETABLE</title>
  <!--Google font-->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css?family=Raleway:300,400,500,600,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;400;500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Elsie+Swash+Caps&display=swap" rel="stylesheet">
  <!-- App css -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  
  
   
  <!-- Responsive css -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
  <div class="container-fluid">
    {% csrf_token %}

    <div class="row">
      <div class="col-6 p-5">
      <input type="text"  class="p-5 border border-danger border-3"id="myInput" >
      </div>
      <div class="col-6 p-5">
    <button type="button"  class="btn btn-primary "id="myBtn">Click me</button>
       </div>
       <div class="row">
         
       
         
         </div>
    </div>
    <div class="row">
      <div class="col-6 p-5">
       <div class="lecture">
         
      </div>
      </div>
      <div class="col-6 p-5">
       <a class="lecture-link"  target="_blank"><button type="button"  class="btn btn-danger "id="myBtn">Attend</button></a>
       </div>
    </div>
  </div>
</div>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>

    <script>
     $(document).ready(function(){
        $('#myBtn').click(function()
        {
          var roll_no=$("#myInput").val()
          console.log(roll_no)
          $("#myInput").val('');
          var ct= new Date();
          var day =["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"]
          const token = document.querySelector('[name=csrfmiddlewaretoken]').value;
          console.log(token);
          console.log(day[ct.getDay()]);

         
          $.ajax({
          url: 'tt/',
          dataType: 'json',
          data : {
                    roll_no: roll_no ,
                    hours: ct.getHours(),
                    minute: ct.getMinutes(),
                     day: day[ct.getDay()]
                  },
          method : 'POST',
         
          success: function (data) {
            $('.lecture').html("<p>ON going lecture is "+data.lecture+ "</p>")
            $('.lecture-link').attr("href",data.link)
          },
          error: function (data) { alert("NO LECture");}
});
      
          
          

        });
       

});
    </script>
</body>
</html>